\subsection{Solution of the Relaxed Problem (Proof of Proposition \ref{prop:relaxed-optimal-contract})} 

Throughout this subsection, fix a reservation utility $\bar U$ and intended action $a_0$. The local IC constraint is only defined if $U(v, a)$ can be differentiated under the integral sign, so we begin by showing that differentiation under the integral at any action is possible for any feasible contract.

\begin{remark} 
    \label{rem:leibniz}
    Let $v$ be a feasible contract. Then, for all $a$ in $\mathbb{R}_{+}$, the first and second derivatives of $U(v,a)$ with respect to $a$ exist, are finite, and are given by
    \[
        U_{a}(v,a) = \int v(y) f_{a}(y|a)\,dy\text{,}
    \]
    \[
        U_{aa}(v,a) = \int v(y) f_{aa}(y|a)\,dy\text{.}
    \]
\end{remark} 

\begin{proof}
    The conditions for Leibniz's rule to hold are in Assumption \ref{assump:leibniz}.2.    
\end{proof} 

 We now derive some intermediate results to establish proposition \ref{prop:relaxed-optimal-contract}. Recall the definition of the Lagrangian from equation (\ref{eq:lagrangian}) and definition \ref{def:canonical-contract} of a canonical contract.

Note that canonical contracts uniquely minimize the Lagrangian:
\begin{lemma}
    \label{lem:lagrangian}
    Given $\lambda$ and $\mu$ in $\mathbb R$, there exists $v$ that minimizes the Lagrangian $\mathcal{L}(v, \lambda, \mu)$ among all feasible contracts. $v$ is $f(\cdot | a_0)$ almost everywhere equal to the canonical contract $V(y, \lambda, \mu)$.
\end{lemma}

\begin{proof}
The Lagrangian in equation (\ref{eq:lagrangian}) can be written as
\[
    \mathcal{L}(v, \lambda, \mu)
    =
    \int [k(v(y)) - \lambda v(y) - \mu v(y)S(y|a_0)]f(y|a_0)\, dy + \bar U
    \text{.}
\]

Differentiating the integrand with respect to $v(y)$ yields
\[
[k'(v(y)) - \lambda - \mu S(y|a_0)]f(y|a_0)
\]

and this is strictly convex in $v(y)$. Therefore, the integrand is minimized pointwise in $v(y)$ at $v(y) = V(y | \lambda, \mu)$. Hence, the infimum is attained, and any minimizer satisfies the desired formula $f(y | a_0)$ almost everywhere.

It only remains to show that $V(y | \lambda, \mu)$ is feasible. This follows from assumption \ref{assump:leibniz} Part 4.
\end{proof}

We now note that, given $\lambda$ there is a unique value of $\mu$ that solves the local IC constraint.

\begin{lemma}
    \label{lem:mu-tilde}
    Given $\lambda$ in $\mathbb R$, there exists a unique $\tilde \mu(\lambda)$ such that the canonical contract $V(y|\lambda, \tilde \mu(\lambda))$ satisfies the local IC constraint (\ref{LIC_relaxed}). Moreover, $\tilde \mu(\lambda) > 0$.
\end{lemma}

\begin{proof}
We have
\[
U_{a}(v)=\int v(y)f_{a}(y|a_{0})\,dy\text{.}
\]
If $\mu=0$, then $v(y)$ is constant, so
\[
    U_{a}(V(\cdot|\lambda,0,a_{0}))-c'(a_{0})<0\text{.}
\]

As $\mu\rightarrow\infty$, $V(y|\lambda,\mu,a_{0})$ converges pointwise to $u(\infty) = \infty$ if $S(y|a_0) > 0$ and to $u(0)$ if $S(y|a_0) < 0)$. Hence, for large enough $\mu$,
\[
    U_{a}(V(\cdot|\lambda,\mu,a_{0}))-c'(a_{0})>0\text{.}
\]

Therefore, there exists at least one $\mu_{1}>0$ such that
\[
    U_{a}(V(\cdot|\lambda,\mu_{1},a_{0}))-c'(a_{0})=0\text{.}
\]

It only remains to prove that this solution $\mu_{1}$ is unique. To see this, note
that
\[
    U_{a}(V(\cdot|\lambda,\mu_{1},a_{0}))
\]
is weakly increasing in $\mu$. And, moreover, it is strictly increasing
at any solution $\mu_{1}$ because $c'(a_0) > 0$ implies that there is a positive measure of $y$ such that
$f_{a}(y|a_{0})>0$ and
\[
\lambda+\mu_{1}\frac{f_{a}(y|a_{0})}{f(y|a_{0})}>\frac{1}{u'(0)}\text{.}
    \]
\end{proof}

The lemma implies that the family of canonical contracts that satisfy (\ref{LIC_relaxed}) is a one-dimensional family indexed by $\lambda$. Define
\begin{equation}
    \label{eq:tildeV-definition}
    \tilde V (y | \lambda) := V(y | \lambda, \tilde \mu(\lambda))
\end{equation}

Define the \textbf{relaxed Pareto problem} as finding $v$ in $\mathcal C$ to
\begin{align}
    \text{minimize} \quad & W(v) - \lambda U(v) \nonumber \\
    \text{subject to} \quad & \partial _a U(v, a_0) = 0 \tag{LIC}
\end{align}

The next lemma shows that the contracts $\tilde V (y|\lambda)$ span the solutions to the Pareto problem:

\begin{lemma}
    \label{lem:pareto-problem}
    Given $\lambda$ in $\mathbb R$, the relaxed Pareto problem has a solution, and any solution is $f(y|a_0)$ almost everywhere equal to $\tilde V (y | \lambda)$.
\end{lemma}
\begin{proof}
For any $v$ satisfying (\ref{LIC_relaxed}),
\[
W(v) - \lambda U(v)
=
\mathcal{L}(v, \lambda, \tilde \mu(\lambda)) - \lambda \bar U
\text{.}
\]

Lemma \ref{lem:lagrangian} then implies that $W(v) - \lambda(v)$ is minimized over $\mathcal C$ by $\tilde V (y | \lambda)$, and that this solution is almost-everywhere unique. This contract satisfies (\ref{LIC_relaxed}) by the definition of $\tilde \mu(\lambda)$.
\end{proof}

Define the expected wage and utility attained by these contracts as
\[
\begin{array}{rcl}
\tilde U (\lambda) & := & U(\tilde V(\cdot | \lambda), a_0) \text{,} \\
\tilde W (\lambda) & := & W(\tilde V(\cdot | \lambda), a_0) \text{.}
\end{array}
\]

\begin{lemma}
    \label{u-tilde-increasing}
    $\tilde U (\lambda)$ is strictly increasing.
\end{lemma}

\begin{proof}
Consider $\lambda _1 < \lambda _2$ with optima $v_1 := \tilde V (\cdot | \lambda_1)$ and $v_2 := \tilde V (\cdot | \lambda_2)$. By optimality,
\[
W(v_1) - \lambda_1 U(v_1) \leq W(v_2) - \lambda_1 U(v_2)
\text{,}
\]
and
\[
W(v_2) - \lambda_2 U(v_2) \leq W(v_1) - \lambda_2 U(v_1)
\text{.}
\]

Adding the inequalities,
\[
(\lambda_2 - \lambda_1) \cdot \left(\tilde U (\lambda _2) - \tilde U (\lambda _ 1) \right) \geq 0
\text{.}
\]

Therefore, $\tilde U$ is non-decreasing. It only remains to show that $\tilde U$ is strictly increasing. To reach a contradiction, assume that $\tilde U(\lambda _ 2) = \tilde U (\lambda _ 1)$. Optimality implies that $\tilde W (\lambda _1) = \tilde W (\lambda _2)$.  Let $\bar \lambda = (\lambda_1 + \lambda_2) / 2$. We have $\tilde U (\bar \lambda) = \tilde U(\lambda _ 1)$. By our assumptions on the score, $v_1$ and $v_2$ differ in a set of positive measure. By strict convexity of $k$, it follows that $\tilde W (\bar \lambda) < \tilde W (\lambda _ 1)$. This contradicts the optimality of $v_1$.
\end{proof}

The proof of proposition \ref{prop:relaxed-optimal-contract} follows from collecting these results.

\begin{proof}[Proof of Proposition \ref{prop:relaxed-optimal-contract}]
Let $\bar U _ L : = \tilde U (0)$ and $\bar U _ R := \lim _ {\lambda \rightarrow \infty} \tilde U (\lambda)$.

\textbf{Part 1.}

The definition of $\bar U _ R$ implies that the relaxed problem is not feasible for $\bar{U} \geq \bar{U}_R$, as desired.

\textbf{Part 2.}

Let $\lambda ^*(\bar U)$ be $0$ if $\bar U \leq \bar U _L$ and be the inverse of $\tilde U$ for $\bar U _L < \bar U < \bar U _R$. Lemma \ref{u-tilde-increasing} implies that $\lambda^*$ is well defined and that $\lambda^*(\bar U) \geq 0$.

Let $\mu ^* (\bar U) := \tilde \mu (\lambda ^* (\bar U))$. Lemma \ref{lem:mu-tilde} implies that $\mu^*(\bar U) > 0$. Let $v^*(y | \bar U) := \tilde V (y | \lambda ^* (\bar U))$. Note that this coincides with the definition of $v^*$ in the proposition statement.

Lemma \ref{lem:pareto-problem} implies that $v^*(y | \bar U)$ solves the Pareto problem given $\lambda^*(\bar U)$. This implies that $v^*(y | \bar U)$ also solves the relaxed cost minimization problem given $\bar U$. Likewise, \ref{lem:pareto-problem} implies that the solution is unique almost everywhere.

\textbf{Part 3, nonbinding individual rationality case.}

This follows from the definition of $\lambda^*(\bar U)$ which equals $0$ in this range.

\textbf{Part 3, binding individual rationality case.}
$\lambda ^*$ strictly increasing follows from lemma $\ref{u-tilde-increasing}$ and the strict convexity of $\omega$ follows from $v^*(\cdot | \lambda)$ being different for each value of $\lambda$ and from $k$ being strictly convex.
    
\end{proof}

 \subsection{Concavity with High Reservation Utility (Proof of Proposition \ref{prop:concave})}
 \label{subsec:proof-derivs}  

 This section demonstrates that the second derivative of agent's utility is negative for sufficiently high reservation utility. The bulk of the section is spent demonstrating the same result for $\lambda$ sufficiently high, and the main result follows as an immediate corollary. Throughout this section, we use the $\tilde V (y | \lambda)$ notation defined in equation (\ref{eq:tildeV-definition}). Although $\tilde \mu(\lambda)$ is a function of $\lambda$ (Lemma \ref{lem:mu-tilde}) we abuse notation by omitting dependence on $\lambda$ and writing $\tilde{\mu}$ to denote $\tilde{\mu}(\lambda)$.

\textbf{Formulae for derivatives of $U(v, a)$}.

\begin{lemma}
\label{lem:second-derivative}
    Given a canonical contract, $v(y) := \tilde V (y | \lambda)$, the agent's utility and its derivatives evaluated at $a$ are  
    \[
    \begin{aligned}
        U \left( v, a \right) 
        &= & g(\lambda) + & \tilde{\mu} \int \Delta g(y | \lambda) \cdot S(y|a_0) \cdot f(y | a) \, dy - c(a), \\
        U_a \left( v, a \right) 
        &= &            & \tilde{\mu} \int \Delta g(y | \lambda) \cdot S(y|a_0) \cdot f_a(y | a) \, dy - c'(a), \\
        U_{aa} \left( v, a \right) 
        &= &            & \tilde{\mu} \int \Delta g(y | \lambda) \cdot S(y|a_0) \cdot f_{aa}(y | a) \, dy - c'(a),
    \end{aligned}
    \]
    where 
    \[
    \Delta g(y | \lambda) = \frac{g(\lambda + \tilde{\mu} S(y |  a_0)) - g(\lambda)}{\tilde{\mu} S(y |  a_0)}.
    \]
\end{lemma}

\begin{proof}
    The utility function, \( U \), evaluated at the canonical contract, $
    \tilde{V}\left( y | \lambda \right)$, and action, $a$, is
    \[
    U \left( \tilde{V}(y|\lambda), a \right) = \int \tilde{V}(y|\lambda) f(y|a) \, dy.
    \]
    Substituting $\tilde{V}(y|\lambda) = g\left( \lambda + \tilde{\mu} S(y|a_0) \right)$ yields 
    \[
    U \left( \tilde{V}(y|\lambda), a \right) = \int g\left( \lambda + \tilde{\mu} S(y|a_0) \right) f(y|a) \, dy.
    \]
    Adding and subtracting \( g(\lambda) \), we rewrite the integral:
    \[
     U \left( \tilde{V}(y|\lambda), a \right) = g(\lambda) + \int \left[ g\left( \lambda + \tilde{\mu} S(y|a_0) \right) - g(\lambda) \right] f(y|a) \, dy.
    \]
    Using the definition of $ \Delta g(y | \lambda) $ and multiplying by $\frac{\tilde{\mu} S(y|a_0)}{\tilde{\mu} S(y|a_0)}$ yields 
     $$ U \left( \tilde{V}(y|\lambda), a \right) = g(\lambda) + \tilde{\mu} \int \Delta g(y | \lambda) \cdot S(y|a_0) f(y | a) \, dy - c(a) .$$

     This yields the formula for $U(v, a)$. The derivatives follow from the Leibniz rule.
\end{proof} 

\textbf{Bounding the probability that the agent receives zero payment}.

\begin{definition}
    \label{def:threshold-score}
     The \textbf{threshold score}, $\ubar{S}(\lambda)$, is the maximum score such that the agent receives no payment. It is the score that solves 
    \[
    \lambda + \tilde \mu \ubar{S}(\lambda) = \frac{1}{u'(0)} \text{,}
    \]
    or, equivalently,
    \[
    \ubar{S}(\lambda) := \frac{1}{\tilde{\mu} u'(0)} - \frac{\lambda}{\tilde{\mu}} \text{.}
    \]  
    The threshold score is well defined because $\tilde{\mu} > 0$ by Lemma \ref{lem:mu-tilde}.
\end{definition}

\begin{definition}
    \label{def:threshold-outcome}
    The \textbf{threshold outcome}, $\ubar{y}(\lambda)$, is the outcome which induces the threshold score, $\ubar{S}(\lambda)$:
    $$ \ubar{y}(\lambda) := S^{-1}(\ubar{S}(\lambda, \tilde{\mu}) |  a_0) .$$ 
    A score that satisfies the equation exists by Assumption \ref{assump:regularity_S}.3, which states that the score's image is $\mathbb{R}$. 
\end{definition} 
    
\begin{lemma} 
    \label{lem:threshold-outcome}
    The threshold outcome approaches negative infinity as $\lambda$ approaches infinity: 
    $$ \lim _ {\lambda \rightarrow \infty} \ubar{y}(\lambda) = -\infty . $$ 
\end{lemma}

\begin{proof}
    Lemma \ref{lem:second-derivative}'s result for $U_a$ evaluated at $a_0$ yields
    $$ U_a  \left( \tilde{V}(y|\lambda), a_0 \right)
        =
        \tilde{\mu} \int
        \Delta g(y | \lambda) \cdot S(y|a_0) f_a(y|a_0) - c'(a_0). $$
    The local incentive compatibility constraint requires that $U_a  \left( \tilde{V}(y|\lambda), a_0 \right)=0$. It follows that    
    $$  \tilde{\mu} \int  \Delta g(y | \lambda) \cdot S(y|a_0) f_a(y|a_0) = c'(a_0). $$ 
    Observe that the term inside the expectation is weakly positive because $\Delta g(y | \lambda) \geq 0 $ and $S(y | a_0)$ has the same sign as $f_a(y|a_0)$.
    Therefore, 
    $$
    c'(a_0) \geq
    \tilde{\mu} \int _{S(y|a_0) \leq \ubar S(\lambda)} \Delta g(y | \lambda) \cdot S(y|a_0) f_a(y|a_0) \, dy \text{.}
    $$
    Substituting $\Delta g(y | \lambda)$ yields
    $$
    c'(a_0) \geq
    \int _{S(y|a_0) \leq \ubar S(\lambda)} (u(0) - g(\lambda)) f_a(y|a_0) \, dy \text{.}
    $$
    Integrating yields: 
    $$ c'(a_0)
    \geq (u(0) - g(\lambda)) \cdot F_a \left( \ubar y (\lambda) | a_0 \right) .$$ 
    Observe that $u(0) - g(\lambda) \rightarrow -\infty$ by Assumption \ref{assump:utility_cost}, and $ F_a(\ubar y (\lambda) | a_0) < 0 $ by Assumption \ref{assump:regularity_S}.2. Suppose $F_a \left( \ubar y (\lambda) | a_0 \right)$ does not approach $0$. Then we have $c'(a_0) \geq \infty$. By contradiction, $F_a \left( \ubar y (\lambda) | a_0 \right) \rightarrow 0$.

    The threshold outcome, $\ubar y (\lambda)$, cannot converge to positive infinity because it is bounded above by the solution to $S(y | a_0) = 0$. To reach a contradiction, assume that $\ubar y (\lambda)$ does not converge to negative infinity. Then there is a subsequence where $\ubar S (\lambda)$ converges to a finite value $y_0$. Then $F_a \left( \ubar y (\lambda) | a_0 \right)$ converges to  $F_a \left( y_0 | a_0 \right)$. Assumption \ref{assump:regularity_S}.2 implies that this is a strictly negative number, reaching a contradiction.
\end{proof}  

\begin{corollary}
\label{cor:mu_lambda} 
As \( \lambda \rightarrow \infty \), we have \( \tilde{\mu}(\lambda) / \lambda \rightarrow 0 \).
\end{corollary}


\begin{proof}
    Lemma \ref{lem:threshold-outcome} and assumption \ref{assump:regularity_S}.3 imply that $\ubar S (\lambda) \rightarrow -\infty$. The result follows from the definition of $\ubar S (\lambda)$.  
\end{proof}

\begin{lemma}
    \label{lem:inf_lambda_second_deriv}
    As $\lambda$ approaches infinity, the limit of the supremum of the second derivative of agent's utility at any action $a > 0$  is strictly negative: 
    $$
    \limsup_{\lambda \to \infty}
    \,
    U_{aa}\left( \tilde{V}\left( y |  \lambda \right), a \right) < 0\text{.}
    $$
\end{lemma} 

\begin{proof}
By Lemma \ref{lem:second-derivative}, 
    $$
    U_{aa}\left( \tilde{V} \left( y |  \lambda \right), a \right)
    =
    g(\lambda) + \tilde{\mu} \int \Delta g(y | \lambda)
    \cdot S(y|a_0)
    \cdot f_{aa}(y | a) \, dy - c''(a)
    $$ 
    Assumption \ref{assump:regularity_S} implies that there exists $y_0$ such that $f_{aa}(y | a) > 0$ for all $y \leq y_0$ and $a$. Because the score is monotone, we can take $y_0$ such that $S(y|a_0) < 0$ for all $y \leq y_0$. Therefore, the integrand is negative for all $y \leq y_0$ and $a$.    
    
    It follows that 
    $$
    U_{aa}\left( \tilde{V} \left( y |  \lambda \right), a \right) \leq
    \tilde{\mu} \int_{y_0}^{\infty} 
    \Delta g(y | \lambda)
    \cdot S(y|a_0)
    \cdot f_{aa}(y | \hat a) \, dy
    - c''(a) \text{.}
    $$

    Let $Y_+$ be the set of $y \geq y_0$ where this integrand is positive. Then 
    $$
    U_{aa}\left( \tilde{V} \left( y |  \lambda \right), a \right) \leq
    \tilde{\mu} \int_{Y_+} 
    \Delta g(y | \lambda)
    \cdot S(y|a_0)
    \cdot f_{aa}(y | \hat a) \, dy
    - c''(a) \text{.}
    $$
    
     Lemma \ref{lem:threshold-outcome} implies that for $\lambda$ sufficiently large, $\ubar y (\lambda, a_0) \leq y_0$. The concavity of $k'^{-1}$ (Assumption \ref{assump:concavity_inverse_marginal_utility}) implies that $\Delta g$ is decreasing for $y$ in $Y_+$. Therefore,
    $$
    U_{aa}\left( \tilde{V} \left( y |  \lambda \right), a \right) \leq
    \tilde{\mu} \int_{Y_+} 
    \Delta g \left(y_0 | \lambda \right)
    \cdot S(y|a_0)
    \cdot f_{aa}(y | \hat a) \, dy
    - c''(a) \text{.}
    $$

    $g(y | \lambda)$ is concave for $y > \ubar y$. Thus,
    \begin{align*}
    \tilde{\mu} \Delta g(y_0 | \lambda)
    &\leq \tilde{\mu} g'(\lambda + \tilde{\mu} S(y_0|a_0)) \\
    &=
        \frac{\tilde{\mu}}{\lambda
        + \tilde{\mu} S(y_0|a_0)}
        \cdot
        (\lambda + \tilde{\mu} S(y_0|a_0))
        g'(\lambda + \tilde{\mu} S(y_0|a_0)). 
    \end{align*}
    Corollary \ref{cor:mu_lambda} states that $\tilde{\mu} / \lambda \rightarrow 0$ as $\lambda \rightarrow \infty $, and Assumption \ref{assump:concavity_inverse_marginal_utility} implies that $(\lambda + \tilde{\mu} S(y_0|a_0)) g'(\lambda + \tilde{\mu} S(y_0|a_0))$ has a finite limit. It follows that 
    $$
    \limsup_{\lambda \to \infty}
    \,
    U_{aa}\left( \tilde{V} \left( y |  \lambda \right), a \right) \leq - c''(a)
    <
    0
    $$ 
    with the last inequality implied by the strict convexity of the cost function (Assumption \ref{assump:utility_cost}). 
\end{proof} 

\textbf{Completing the proof of Proposition \ref{prop:concave}.}
\begin{proof}[Proof of Proposition \ref{prop:concave}]
    We first prove that there exists $\lambda_0$ such that, for all $\lambda \geq \lambda _0$ and $a$ in $\mathcal A$,
    \[
        U_{aa} \left(\tilde V(y | \lambda), a \right)
        \leq
        0\text{.}
    \]
    
    To reach a contradiction, assume that this is not the case. Then there exists a sequence of $\lambda_n \rightarrow \infty$ and $a_k$ in $\mathcal A$ such that
    \[
        U_{aa} \left(\tilde V(y | \lambda_n), _n \right) > 0\text{.}
    \]
    
    Because $\mathcal A$ is compact, we can take a convergent subsequence where $a_k \rightarrow a_1$. Therefore,
    \[
        \limsup _ {\lambda \rightarrow \infty}
        U_{aa}(\tilde V(y | \lambda), a_1) > 0\text{.}
    \]
    This contradicts Lemma \ref{lem:inf_lambda_second_deriv}.
    
    For any $\lambda \geq \lambda_0$, we thus have that $U(\tilde V (y | \lambda), a)$ is concave in $a$. The proposition is proven by letting $U^*$ be the solution to $\lambda^*(U^*) = \lambda_0$. The agent's problem is concave in $a$ for $\bar{U} \geq U^*$ because $\lambda^*(\bar{U})$ is monotonic by Proposition \ref{prop:relaxed-optimal-contract}.
\end{proof}